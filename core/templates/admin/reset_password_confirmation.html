{% extends "admin/base_site.html" %}
{% load i18n admin_urls static %}

{% block extrahead %}
    {{ block.super }}
    {{ media }}
{% endblock %}

{% block bodyclass %}{{ block.super }} app-{{ opts.app_label }} model-{{ opts.model_name }} delete-confirmation{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">–ì–ª–∞–≤–Ω–∞—è</a>
    &rsaquo; <a href="{% url 'admin:auth_user_changelist' %}">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
    &rsaquo; –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
</div>
{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 20px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    <h1 style="color: #417690; margin-bottom: 20px;">–°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h1>
    
    <div style="background: #ffc; border: 1px solid #ed9; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
        <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
    </div>
    
    <ul style="margin: 20px 0; padding-left: 20px;">
        {% for user in users %}
        <li style="margin: 8px 0;">
            <strong>{{ user.username }}</strong>
            {% if user.first_name or user.last_name %}
                ({{ user.first_name }} {{ user.last_name }})
            {% endif %}
            {% if user.email %}
                - {{ user.email }}
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    
    <form method="post" style="margin-top: 30px;">
        {% csrf_token %}
        
        <div style="margin-bottom: 20px;">
            <label for="new_password" style="display: block; font-weight: bold; margin-bottom: 8px;">
                –ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:
            </label>
            <input 
                type="password" 
                id="new_password" 
                name="new_password" 
                required
                minlength="8"
                style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;"
                placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤"
            >
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="confirm_password" style="display: block; font-weight: bold; margin-bottom: 8px;">
                –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è:
            </label>
            <input 
                type="password" 
                id="confirm_password" 
                name="confirm_password" 
                required
                minlength="8"
                style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;"
                placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
            >
        </div>
        
        <div style="margin-top: 30px; display: flex; gap: 10px;">
            <input type="hidden" name="action" value="reset_password_action">
            <input type="hidden" name="{{ action_checkbox_name }}" value="1">
            {% for user in users %}
            <input type="hidden" name="{{ action_checkbox_name }}" value="{{ user.pk }}">
            {% endfor %}
            
            <input 
                type="submit" 
                name="apply" 
                value="–î–∞, —Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å"
                style="background: #417690; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;"
            >
            <a 
                href="{% url 'admin:auth_user_changelist' %}" 
                style="background: #ba2121; color: white; padding: 10px 20px; border-radius: 4px; text-decoration: none; display: inline-block; font-size: 14px; font-weight: bold;"
            >
                –û—Ç–º–µ–Ω–∞
            </a>
        </div>
    </form>
    
    <div style="margin-top: 20px; padding: 15px; background: #e8f4f8; border-radius: 4px; font-size: 13px;">
        <strong>üí° –°–æ–≤–µ—Ç:</strong> –ü–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–æ–±—â–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–∞–Ω–∞–ª —Å–≤—è–∑–∏.
    </div>
</div>

<script>
document.querySelector('form').addEventListener('submit', function(e) {
    const password = document.getElementById('new_password').value;
    const confirm = document.getElementById('confirm_password').value;
    
    if (password !== confirm) {
        e.preventDefault();
        alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
        return false;
    }
    
    if (password.length < 8) {
        e.preventDefault();
        alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤!');
        return false;
    }
    
    return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?');
});
</script>
{% endblock %}
